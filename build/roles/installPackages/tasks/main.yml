---
# tasks file for installPackages
- name: Install packages
  community.general.pacman:
    name:
      - linux-hardened
      - linux-hardened-headers
      - amd-ucode
      - nftables
      - vim
      - cloud-init
      - sudo
      - jq
    state: latest
    update_cache: true

- name: Gather the package facts
  ansible.builtin.package_facts:
    manager: pacman

- name: Write package list to /packages.yaml
  ansible.builtin.blockinfile:
    create: true
    path: /packages.yaml
    block: "{{ ansible_facts.packages }}"

- name: Store file into ./packages.yaml
  ansible.builtin.fetch:
    src: /packages.yaml
    dest: ./packages.yaml
